# description: nginx config variables

export PHP_FPM_listen=${PHP_FPM_listen:-9000}
export NGINX_listen=${NGINX_listen:-${NGINX_port}}
export NGINX_listen_options=${NGINX_listen_options:-default_server}
export NGINX_user=${NGINX_user:-$(id -un)}
export NGINX_server_name=${NGINX_server_name:-'_'}
export NGINX_documentroot=${NGINX_documentroot:-${APP_dest}}

# set php handler
# if PHP_FPM_host is set, use tcp socket.
# Otherwise, unix socket is used
if ! [ -z ${PHP_FPM_host} ] ; then
    export NGINX_fastcgi_pass=${NGINX_fastcgi_pass:-${PHP_FPM_host}:${PHP_FPM_port:-9000}}
else
    if [[ ${PHP_FPM_listen} == /* ]]; then
        export NGINX_fastcgi_pass=${NGINX_fastcgi_pass:-unix:${PHP_FPM_listen}|fcgi://localhost}
    elif ! [[ $PHP_FPM_listen == *':'* ]]; then
        export NGINX_fastcgi_pass=${NGINX_fastcgi_pass:-127.0.0.1:${PHP_FPM_listen}}
    else
       export NGINX_fastcgi_pass=${NGINX_fastcgi_pass:-${PHP_FPM_listen}}
    fi
fi
