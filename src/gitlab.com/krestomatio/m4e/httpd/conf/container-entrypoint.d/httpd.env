# description: httpd config variables

export PHP_FPM_listen=${PHP_FPM_listen:-9000}
export HTTPD_listen=${HTTPD_listen:-${HTTPD_port}}
export HTTPD_user=${HTTPD_user:-$(id -un)}
export HTTPD_group=${HTTPD_group:-${CTR_group}}
export HTTPD_documentroot=${HTTPD_documentroot:-${HTTPD_public_path}}

# set php handler
# if PHP_FPM_host is set, use tcp socket.
# Otherwise, unix socket is used (default)
if ! [ -z ${PHP_FPM_host} ] ; then
    export HTTPD_php_sethandler=${HTTPD_php_sethandler:-proxy:fcgi://${PHP_FPM_host}:${PHP_FPM_port:-9000}}
else
    if [[ ${PHP_FPM_listen} == /* ]]; then
        export HTTPD_php_sethandler=${HTTPD_php_sethandler:-proxy:unix:${PHP_FPM_listen}|fcgi://localhost}
    elif ! [[ $PHP_FPM_listen == *':'* ]]; then
        export HTTPD_php_sethandler=${HTTPD_php_sethandler:-proxy:fcgi://127.0.0.1:${PHP_FPM_listen}}
    else
        export HTTPD_php_sethandler=${HTTPD_php_sethandler:-proxy:fcgi://${PHP_FPM_listen}}
    fi
fi
