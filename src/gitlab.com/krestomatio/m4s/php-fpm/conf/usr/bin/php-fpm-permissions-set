#!/bin/bash -e
# description: set files/dirs permissions for php-fpm
# https://docs.openshift.com/container-platform/4.2/openshift_images/create-images.html#use-uid_create-image

rpm-file-permissions

# In order to drop the root user, we have to make some directories world
# writeable as OpenShift default security model is to run the container under
# random UID.

mkdir -p ${PHP_run}

chmod -R a+rwx ${PHP_run}
chmod -R a+rwx ${PHP_conf_file}
chmod -R a+rwx ${PHP_conf_dir}
chmod -R a+rwx ${PHP_FPM_conf_dir}
chmod -R a+rwx ${PHP_FPM_conf_file}

chown -R ${CTR_user_id}:${CTR_group_id} ${PHP_run}
chown -R ${CTR_user_id}:${CTR_group_id} ${HTTPD_public_path}
