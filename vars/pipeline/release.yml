version_include_major_minor_tags: true
version_commit_tag: "{{ lookup('pipe', 'git rev-parse HEAD') | default(false) }}"
build_image_name: "{{ build_registry_path }}/{{ ansible_host }}"
git_add_path: vars/state generated_contexts/
git_commit_msgs:
  - "chore(ci): save state of images"
  - "[skip.ci]"
pr_commit_tag: "{{ lookup('pipe', 'git rev-parse HEAD^2 &>/dev/null && git rev-parse HEAD^2 || echo') |
  default(false,true)}}"
artifact_tag: "{{ pr_commit_tag }}"
state_yml_artifact_tag: "{{ artifact_tag }}"
state_path: "{{ working_dir }}/vars/state"
git_tag_options: -f
git_tag: "v{{ release_version }}"
release_version:  "{{ lookup('pipe', 'git semver --next-patch || echo') | default(false,true) }}"
state_image_match_artifact_tag: false
end_host: "{{ not state_image_match_artifact_tag }}"
end_host_msg: "artifact tag for pipeline does not match the one in state image file"
promote_copy_throttle: 4
git_push_options: --tags
